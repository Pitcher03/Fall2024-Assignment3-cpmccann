@{
    ViewBag.Title = "Manage Movies";

    List<Actor> actors = new List<Actor>();
}

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
<h1>Movies</h1>
<p>Use the tabs below to view, add, edit, or delete movies.</p>
<ul class="nav nav-tabs" id="movieTab" role="tablist">
    <li class="nav-item">
        <a class="nav-link active" id="view-tab" data-toggle="tab" href="#view" role="tab" aria-controls="view" aria-selected="true">View Movies</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="add-tab" data-toggle="tab" href="#add" role="tab" aria-controls="add" aria-selected="false">Add Movie</a>
    </li>
</ul>
<div class="tab-content">
    <div class="tab-pane fade show active" id="view" role="tabpanel" aria-labelledby="view-tab">
        <div id="movieResultsContainer">Loading movies...</div>
        <div id="editMovieModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="editMovieModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document" style="padding-top: 100px;">
                <div class="modal-content">
                    <div class="modal-header" style="color: ghostwhite;">
                        <h5 class="modal-title" id="editMovieModalLabel">Edit Movie</h5>
                        <button type="button" class="close" aria-label="Close" onclick="CloseEditMovieModal()">
                            <span aria-hidden="true" style="color: ghostwhite;">&times;</span>
                        </button>
                    </div>
                    <form id="editMovieForm" asp-area="" asp-controller="Movie" asp-action="EditMovie" method="post">
                        <div class="modal-body" style="max-height: 400px; overflow-y: auto;">
                            <input id="movieId" name="id" style="display: none;">
                            <div class="form-group">
                                <label for="editMovieName">Title</label>
                                <input id="editMovieName" type="text" class="form-control" name="name" placeholder="Movie Name">
                            </div>
                            <div class="form-group">
                                <label for="editMovieYear">Release Year</label>
                                <input id="editMovieYear" type="number" class="form-control" name="year" placeholder="Release Year">
                            </div>
                            <div class="form-group">
                                <label for="editMovieGenre">Genre</label>
                                <select id="editMovieGenre" class="form-control" name="genre">
                                    <option value="Action">Action</option>
                                    <option value="Horror">Horror</option>
                                    <option value="Drama">Drama</option>
                                    <option value="Comedy">Comedy</option>
                                    <option value="Science Fiction">Science Fiction</option>
                                    <option value="Fantasy">Fantasy</option>
                                    <option value="Romance">Romance</option>
                                    <option value="Thriller">Thriller</option>
                                    <option value="Animation">Animation</option>
                                    <option value="Documentary">Documentary</option>
                                    <option value="Mystery">Mystery</option>
                                    <option value="Biography">Biography</option>
                                    <option value="Sports">Sports</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editMovieDescription">Description</label>
                                <textarea id="editMovieDescription" class="form-control" name="description" rows="5" placeholder="Add a description..."></textarea>
                            </div>
                            <div class="form-group">
                                <label for="editMovieImdbLink">IMDB Link</label>
                                <input id="editMovieImdbLink" type="url" class="form-control" name="imdblink" placeholder="Add a link to IMDB...">
                            </div>
                            <div class="form-group">
                                <label for="editMovieCoverImageLink">Cover Image Link</label>
                                <input id="editMovieCoverImageLink" type="url" class="form-control" name="coverimagelink" placeholder="Add a link to the cover image...">
                            </div>
                            <div class="form-group">
                                <label for="editMovieActors">Select Actors</label>
                                <select id="editMovieActors" multiple class="form-control" name="actors">
                                    <option disabled selected value="none">Select Actors</option>
                                </select>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-primary">Update Movie</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="tab-pane fade" id="add" role="tabpanel" aria-labelledby="add-tab">
        <form id="addMovieForm" asp-area="" asp-controller="Movie" asp-action="AddMovie" method="post">
            <div class="form-group">
                <input type="text" name="name" class="form-control" placeholder="Movie Name" required>
            </div>
            <div class="form-group">
                <input type="number" name="year" class="form-control" placeholder="Release Year" required>
            </div>
            <div class="form-group">
                <select class="form-control" name="genre" required>
                    <option disabled selected value="none">Genre</option>
                    <option value="Action">Action</option>
                    <option value="Horror">Horror</option>
                    <option value="Drama">Drama</option>
                    <option value="Comedy">Comedy</option>
                    <option value="Science Fiction">Science Fiction</option>
                    <option value="Fantasy">Fantasy</option>
                    <option value="Romance">Romance</option>
                    <option value="Thriller">Thriller</option>
                    <option value="Animation">Animation</option>
                    <option value="Documentary">Documentary</option>
                    <option value="Mystery">Mystery</option>
                    <option value="Biography">Biography</option>
                    <option value="Sports">Sports</option>
                </select>
            </div>
            <div class="form-group">
                <textarea id="description" name="description" class="form-control" rows="3" placeholder="Add a description..."></textarea>
            </div>
            <div class="form-group">
                <input type="url" name="imdblink" class="form-control" placeholder="Add a link to IMDB...">
            </div>
            <div class="form-group">
                <input type="url" name="coverimagelink" class="form-control" placeholder="Add a link to the cover image...">
            </div>
            <div class="form-group">
                <label for="actors">Select Actors</label>
                <select multiple class="form-control" name="actors">
                    <option disabled selected value="none">Select Actors</option>
                    <!-- Populate actor options here -->
                    <option value="actor-1">Actor 1</option>
                    <option value="actor-2">Actor 2</option>
                    <option value="actor-3">Actor 3</option>
                    <option value="add-custom-actor">Add Custom Actor...</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Add Movie</button>
        </form>
    </div>
    <div id="viewMovieModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-xl modal-dialog-centered" role="document">
            <div class="modal-content" style="background-color: rgba(0,0,0,0.9); color: white; margin-top: 70px;">
                <div class="modal-header bg-dark text-light">
                    <h5 id="viewMovieName" class="modal-title"></h5>
                    <button type="button" class="close text-light" onclick="CloseViewMovieModal()" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body p-4 d-flex">
                    <div class="movie-cover-image" id="viewMovieCoverImage"></div>
                    <div class="movie-info ml-4 flex-fill">
                        <p><strong>Year:</strong> <span id="viewMovieYear"></span></p>
                        <p><strong>Genre:</strong> <span id="viewMovieGenre"></span></p>
                        <p><strong>Description:</strong> <span id="viewMovieDescription"></span></p>
                        <p><strong>Actors:</strong> <span id="viewMovieActors"></span></p>
                        <a id="viewMovieImdbLink" href="" target="_blank" class="btn btn-outline-info mt-3">
                            View on IMDb
                        </a>
                    </div>
                </div>
                <hr class="m-0">
                <div class="modal-footer flex-column align-items-start bg-light">
                    <h6 class="text-dark">Reviews</h6>
                    <div id="viewMovieReviews" class="reviews-container w-100">
                        <p><strong>Reviewer 1:</strong> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus lacinia odio vitae vestibulum.</p>
                        <p><strong>Reviewer 2:</strong> Curabitur ac felis arcu. Sed eleifend, lectus sit amet pharetra tincidunt, est est facilisis.</p>
                        <p><strong>Reviewer 3:</strong> Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>
                        <p><strong>Reviewer 4:</strong> Praesent ac semper neque. Donec vel ligula nec erat tempus.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $('#view-tab').on('click', function () {
            $.ajax({
                url: '@Url.Action("GetMovies", "Movie")',
                type: 'GET',
                success: function (html) {
                    html = html.substring(html.indexOf('movieResultsStart') - 9, html.indexOf('movieResultsEnd') + 31);
                    $('#movieResultsContainer').html(html);
                },
                error: function (e) {
                    console.log(e);
                }
            });
        });

        $('#view-tab').trigger('click');
    });
</script>
<script>
    function OpenEditMovieModal(id, name, year, genre, description, imdblink, coverimagelink) {
        document.getElementById('editMovieModal').style.display = "block";
        document.getElementById('editMovieModal').style.opacity = "1";
        document.getElementById('movieId').value = id;
        document.getElementById('editMovieName').value = name;
        document.getElementById('editMovieYear').value = year;
        document.getElementById('editMovieGenre').value = genre;
        document.getElementById('editMovieDescription').value = description;
        document.getElementById('editMovieImdbLink').value = imdblink;
        document.getElementById('editMovieCoverImageLink').value = coverimagelink;
    }

    function CloseEditMovieModal() {
        document.getElementById('editMovieModal').style.display = "none";
    }

    function OpenViewMovieModal(name, year, genre, description, imdblink, coverimagelink, actors, reviews) {
        document.getElementById('viewMovieModal').style.display = "block";
        document.getElementById('viewMovieModal').style.opacity = "1";
        document.getElementById('viewMovieName').innerText = name;
        document.getElementById('viewMovieYear').innerText = year;
        document.getElementById('viewMovieGenre').innerText = genre;
        document.getElementById('viewMovieDescription').innerText = description;
        document.getElementById('viewMovieImdbLink').href = imdblink;
        document.getElementById('viewMovieCoverImage').style.backgroundImage = `url('${coverimagelink}')`;
        document.getElementById('viewMovieActors').innerText = actors;
        document.getElementById('viewMovieReviews').innerHTML = reviews;
    }

    function CloseViewMovieModal() {
        document.getElementById('viewMovieModal').style.display = "none";
    }

</script>